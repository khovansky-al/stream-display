!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).StreamDisplay=e()}(this,function(){"use strict";var t=function(t,e,n,i){return new(n||(n=Promise))(function(a,r){function o(t){try{c(i.next(t))}catch(t){r(t)}}function s(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){t.done?a(t.value):new n(function(e){e(t.value)}).then(o,s)}c((i=i.apply(t,e||[])).next())})},e=function(t,e){var n,i,a,r,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(a=2&r[0]?i.return:r[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,r[1])).done)return a;switch(i=0,a&&(r=[2&r[0],a.value]),r[0]){case 0:case 1:a=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,i=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===r[0]||2===r[0])){o=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){o.label=r[1];break}if(6===r[0]&&o.label<a[1]){o.label=a[1],a=r;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(r);break}a[2]&&o.ops.pop(),o.trys.pop();continue}r=e.call(t,o)}catch(t){r=[6,t],i=0}finally{n=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},n={video:{cursor:"never"},audio:!1};return function(){function i(i){var a=this;this.rAFId=0,this.streamHeight=0,this.streamWidth=0,this.startCapture=function(){return t(a,void 0,void 0,function(){var t,i;return e(this,function(e){switch(e.label){case 0:return t=navigator.mediaDevices,i=this.video,[4,t.getDisplayMedia(n)];case 1:return i.srcObject=e.sent(),this.video.play(),this.setupCanvas(),this.rAFId=requestAnimationFrame(this.stream),[2]}})})},this.stopCapture=function(){cancelAnimationFrame(a.rAFId),a.video.srcObject.getTracks().forEach(function(t){return t.stop()})},this.stream=function(){a.drawVideoToCanvas(),a.callback(a.getImageData()),a.rAFId=requestAnimationFrame(a.stream)},this.video=document.createElement("video"),this.canvas=document.createElement("canvas");var r=this.canvas.getContext("2d");if(null==r)throw"Cannot initialize canvas context";this.canvasContext=r,this.callback=i}return i.prototype.setupCanvas=function(){var t=this.video.srcObject.getVideoTracks()[0].getSettings(),e=t.height,n=t.width;this.streamWidth=n||0,this.streamHeight=e||0,this.canvas.height=this.streamHeight,this.canvas.width=this.streamWidth},i.prototype.drawVideoToCanvas=function(){var t=this.streamHeight,e=this.streamWidth,n=this.video;this.canvasContext.drawImage(n,0,0,e,t)},i.prototype.getImageData=function(){var t=this.streamHeight,e=this.streamWidth;return this.canvasContext.getImageData(0,0,e,t)},i}()});
//# sourceMappingURL=stream-display.js.map
