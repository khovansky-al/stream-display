!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).StreamDisplay=e()}(this,function(){"use strict";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var e,n=function(t,e){return t(e={exports:{}},e.exports),e.exports}(function(e,n){var a=t&&t.__awaiter||function(t,e,n,a){return new(n||(n=Promise))(function(i,r){function o(t){try{c(a.next(t))}catch(t){r(t)}}function s(t){try{c(a.throw(t))}catch(t){r(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(o,s)}c((a=a.apply(t,e||[])).next())})},i=t&&t.__generator||function(t,e){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=e.call(t,o)}catch(t){r=[6,t],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(n,"__esModule",{value:!0});var r={video:{cursor:"never"},audio:!1},o=function(){function t(e,n){var o=this;void 0===n&&(n={}),this.intervalId=0,this.scanInterval=t.DEFAULT_SCAN_INTERVAL_MS,this.streamHeight=0,this.streamWidth=0,this.startCapture=function(){return a(o,void 0,void 0,function(){var t,e;return i(this,function(n){switch(n.label){case 0:return t=navigator.mediaDevices,e=this.video,[4,t.getDisplayMedia(r)];case 1:return e.srcObject=n.sent(),this.video.play(),this.setupCanvas(),this.stream(),this.intervalId=window.setInterval(this.stream,this.scanInterval),[2]}})})},this.stopCapture=function(){window.clearInterval(o.intervalId),o.video.srcObject.getTracks().forEach(function(t){return t.stop()})},this.setupCanvas=function(){var t=o.video.srcObject.getVideoTracks()[0].getSettings(),e=t.height,n=t.width;o.streamWidth=n||0,o.streamHeight=e||0,o.canvas.height=o.streamHeight,o.canvas.width=o.streamWidth},this.stream=function(){o.drawVideoToCanvas(),o.callback(o.getImageData())},this.video=document.createElement("video"),this.canvas=document.createElement("canvas");var s=this.canvas.getContext("2d");if(null==s)throw"Cannot initialize canvas context";this.canvasContext=s,this.callback=e;var c=(n||{}).scanInterval;this.scanInterval=c||this.scanInterval,this.validateScanInterval(this.scanInterval)}return t.prototype.drawVideoToCanvas=function(){var t=this.streamHeight,e=this.streamWidth,n=this.video;this.canvasContext.drawImage(n,0,0,e,t)},t.prototype.getImageData=function(){var t=this.streamHeight,e=this.streamWidth;return this.canvasContext.getImageData(0,0,e,t)},t.prototype.validateScanInterval=function(t){t>=1e3||console.warn("      [stream-display] Scan interval is set under 1000ms.       Will be overridden by the browser to 1000ms when tab is in background")},t.DEFAULT_SCAN_INTERVAL_MS=1e3,t}();n.default=o});return(e=n)&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e});
//# sourceMappingURL=stream-display.js.map
